(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4660:(e,t,l)=>{Promise.resolve().then(l.bind(l,9283))},9283:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>r});var n=l(5155),s=l(2115),a=l(6597);let i=e=>{let t=new a.uE;t.addFont("https://cdn.jsdelivr.net/npm/dejavu-fonts-ttf@2.37.3/ttf/DejaVuSans.ttf","DejaVuSans","normal"),t.setFont("DejaVuSans");let l=20;t.setFontSize(16),t.text("Поздравления",105,l,{align:"center"}),t.setFontSize(12),e.forEach((e,n)=>{(l+=20)>250&&(t.addPage(),l=20);let s="".concat(n+1,". ").concat(e),a=t.splitTextToSize(s,180);t.text(a,15,l),l+=(a.length-1)*7});let n=new Date().toISOString().split("T")[0];t.save("Поздравления_".concat(n,".pdf"))};function r(){let[e,t]=(0,s.useState)(!1),[l,a]=(0,s.useState)(null),r=(0,s.useRef)(null),o=async()=>{try{var e,l;a(null),t(!0);let n=null==(l=r.current)||null==(e=l.files)?void 0:e[0];if(!n)return void a("Пожалуйста, выберите Excel файл");let s=await new Promise((e,t)=>{let l=new FileReader;l.onload=()=>{let t=l.result.split(",")[1];e(t)},l.onerror=t,l.readAsDataURL(n)}),o=await fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({excelData:s})});if(!o.ok)throw Error("Failed to generate wishes");let{wishes:c}=await o.json();(null==c?void 0:c.length)>0?await i(c.map(e=>e.wish)):a("Не найдено именинников или юбиляров в текущем месяце")}catch(e){a("Произошла ошибка при обработке файла"),console.error(e)}finally{t(!1)}};return(0,n.jsx)("main",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-blue-50 to-white p-4",children:(0,n.jsxs)("div",{className:"text-center space-y-8",children:[(0,n.jsx)("h1",{className:"text-4xl md:text-5xl font-bold text-gray-800 mb-6 animate-fade-in",children:"Сгенерировать поздравляши"}),(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,n.jsx)("input",{type:"file",accept:".xlsx,.xls",ref:r,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),(0,n.jsx)("button",{onClick:o,disabled:e,className:"px-8 py-4 bg-blue-600 text-white rounded-lg font-semibold\n                     transform transition-all duration-200 \n                     ".concat(e?"opacity-75 cursor-not-allowed":"hover:scale-105 hover:bg-blue-700","\n                     focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n                     shadow-lg hover:shadow-xl\n                     inline-flex items-center justify-center min-w-[200px]"),children:e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Генерация..."]}):"Начать генерацию"}),l&&(0,n.jsx)("div",{className:"text-red-600 mt-2",children:l})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[930,913,441,684,358],()=>t(4660)),_N_E=e.O()}]);